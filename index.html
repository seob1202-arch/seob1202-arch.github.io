<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#0f172a">
    
    <meta name="description" content="í•´ì™¸ í•œì¸ ìƒí™œì˜ ëª¨ë“  ê²ƒì„ ì—°ê²°í•˜ëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ í”Œë«í¼">
    <meta property="og:title" content="Kornect - í•´ì™¸ í•œì¸ ë¹„ì¦ˆë‹ˆìŠ¤ ê²€ìƒ‰">
    
    <title>Kornect - í•´ì™¸ í•œì¸ ë¹„ì¦ˆë‹ˆìŠ¤ ê²€ìƒ‰</title>
    
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="Kornect Logo 192X192.png">

    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard-dynamic-subset.css" />
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
    
    <style>
        /* =========================================
           CORE & MOBILE BASE STYLES 
           ========================================= */
        :root {
            --primary-gradient: linear-gradient(135deg, #6366f1 0%, #a855f7 100%);
            --primary-color: #6366f1;
            --sos-gradient: linear-gradient(135deg, #ef4444 0%, #f87171 100%);
            --bg-dark: #0f172a;
            --bg-card: #1e293b;
            --bg-icon: #334155;
            --text-main: #f1f5f9;
            --text-sub: #94a3b8;
            --text-white: #ffffff;
            --radius-lg: 24px;
            --safe-top: env(safe-area-inset-top);
            --safe-bottom: env(safe-area-inset-bottom);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body {
            font-family: "Pretendard Variable", Pretendard, sans-serif;
            background: var(--bg-dark);
            color: var(--text-main);
            /* ëª¨ë°”ì¼ ë¸Œë¼ìš°ì € UI ëŒ€ì‘ì„ ìœ„í•œ ë†’ì´ ì„¤ì • ìˆ˜ì • (dvh ì ìš©) */
            min-height: 100vh;
            min-height: 100dvh; 
            overflow: hidden; 
            display: flex;
            justify-content: center;
        }

        ::-webkit-scrollbar { width: 6px; display: none; }
        
        .app-container {
            width: 100%; 
            /* í™”ë©´ ê½‰ ì±„ìš°ê¸° (dvh ì ìš©) */
            height: 100vh;
            height: 100dvh;
            display: flex; flex-direction: column;
            position: relative; overflow: hidden;
            background: var(--bg-dark);
            max-width: 100%;
        }

        /* Page Transitions */
        .page {
            position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            background: var(--bg-dark);
            overflow-y: auto; overflow-x: hidden;
            /* í•˜ë‹¨ í”Œë¡œíŒ… ë²„íŠ¼ì´ ë‚´ìš©ì„ ê°€ë¦¬ì§€ ì•Šë„ë¡ ì—¬ë°± í™•ë³´ */
            padding-bottom: calc(120px + var(--safe-bottom)); 
            display: none; z-index: 10;
        }
        #mainPage { display: block; }
        .page.active { display: block; animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* Header */
        .app-header {
            padding: calc(16px + var(--safe-top)) 20px 16px;
            background: rgba(15, 23, 42, 0.9);
            backdrop-filter: blur(12px);
            position: sticky; top: 0; z-index: 50;
            display: flex; align-items: center; justify-content: space-between;
            width: 100%;
        }
        
        .header-brand { display: flex; flex-direction: column; justify-content: center; gap: 5px; }
        .header-brand-img { height: 42px; width: auto; object-fit: contain; object-position: left; display: block; }
        .header-brand-slogan { font-size: 14.3px; font-weight: 600; color: #ffffff; letter-spacing: -0.02em; line-height: 1.1; opacity: 0.95; white-space: nowrap; }

        .header-actions { display: flex; gap: 8px; }
        .btn-circle { width: 40px; height: 40px; background: rgba(255,255,255,0.05); border-radius: 50%; color: white; border: none; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: 0.2s; z-index: 60; position: relative;}
        
        /* Main Content */
        .content-container { padding: 0 20px 24px; }
        .section { margin-bottom: 32px; }
        .section-header { margin-bottom: 16px; }
        .section-title { font-size: 19px; font-weight: 700; color: var(--text-white); display: flex; align-items: center; gap: 6px; }

        /* Category Grid */
        .category-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(70px, 1fr)); 
            gap: 24px 10px; 
        }
        .cat-item { display: flex; flex-direction: column; align-items: center; gap: 10px; cursor: pointer; transition: transform 0.2s; }
        .cat-icon-box { width: 60px; height: 60px; background: var(--bg-card); border-radius: 22px; display: flex; align-items: center; justify-content: center; color: white; transition: 0.2s; }
        .cat-icon-box .material-icons-round { font-size: 28px; }
        .cat-item:active .cat-icon-box { transform: scale(0.95); filter: brightness(1.2); }
        .cat-name { font-size: 12px; color: var(--text-sub); font-weight: 500; text-align: center; white-space: nowrap; }

        /* Modern Menu Grid */
        .modern-menu-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; }
        .modern-card { background: var(--bg-card); border-radius: 20px; padding: 16px; display: flex; flex-direction: column; gap: 12px; cursor: pointer; transition: 0.2s; border: 1px solid rgba(255,255,255,0.05); }
        .modern-card:active { transform: scale(0.98); background: rgba(255,255,255,0.1); }
        .modern-icon { width: 44px; height: 44px; border-radius: 14px; display: flex; align-items: center; justify-content: center; font-size: 24px; }
        
        .theme-orange { background: rgba(251, 146, 60, 0.15); color: #fb923c; }
        .theme-indigo { background: rgba(99, 102, 241, 0.15); color: #818cf8; }
        .theme-pink { background: rgba(244, 114, 182, 0.15); color: #f472b6; }
        .theme-blue { background: rgba(59, 130, 246, 0.15); color: #60a5fa; }
        .theme-teal { background: rgba(45, 212, 191, 0.15); color: #2dd4bf; }
        .theme-purple { background: rgba(167, 139, 250, 0.15); color: #a78bfa; }
        
        .modern-card-text { display: flex; flex-direction: column; gap: 4px; }
        .modern-card-title { font-size: 15px; font-weight: 700; color: white; }
        .modern-card-desc { font-size: 11px; color: var(--text-sub); }

        /* Banner & Stats */
        .banner-card { background: var(--primary-gradient); border-radius: var(--radius-lg); padding: 24px; display: flex; align-items: center; justify-content: space-between; box-shadow: 0 0 20px rgba(99, 102, 241, 0.4); margin-bottom: 32px; text-decoration: none; transition: transform 0.2s; }
        .banner-title { font-size: 18px; font-weight: 800; color: white; display: block; margin-bottom: 4px;}
        .banner-desc { font-size: 13px; color: rgba(255,255,255,0.9); display: block;}
        .banner-icon { font-size: 32px; background: rgba(255,255,255,0.2); padding: 12px; border-radius: 50%; color: white; }

        .stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-bottom: 32px; }
        .stat-card { background: rgba(255,255,255,0.03); padding: 16px 8px; border-radius: 16px; text-align: center; }
        .stat-number { font-size: 20px; font-weight: 800; color: var(--primary-color); margin-bottom: 4px; }
        .stat-label { font-size: 11px; color: var(--text-sub); }

        /* Horizontal Scroll & Biz Card */
        .h-scroll-view { display: flex; gap: 16px; overflow-x: auto; padding-right: 20px; margin-right: -20px; padding-bottom: 10px; }
        .biz-card-sm { min-width: 200px; background: var(--bg-card); border-radius: 16px; padding: 16px; display: flex; flex-direction: column; cursor: pointer; transition: transform 0.2s; }
        .biz-title { font-size: 15px; font-weight: 700; color: white; margin-bottom: 4px; }
        .biz-meta { font-size: 12px; color: var(--text-sub); }
        .biz-rating-badge { margin-top: 10px; font-size: 12px; color: #fbbf24; font-weight: 700; }

        /* Search & Results */
        .search-btn { width: 100%; padding: 18px; background: var(--primary-gradient); border: none; border-radius: 16px; color: white; font-weight: 700; margin-top: 20px; cursor: pointer; transition: 0.2s; }
        .location-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }
        .location-chip { padding: 12px; text-align: center; background: var(--bg-card); border: 1px solid rgba(255,255,255,0.1); border-radius: 12px; color: var(--text-sub); font-size: 13px; font-weight: 600; cursor: pointer; }
        .location-chip.selected { background: var(--primary-color); color: white; border-color: var(--primary-color); }
        .service-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; }
        .service-item { padding: 14px; text-align: center; background: var(--bg-card); border-radius: 12px; color: var(--text-main); font-size: 14px; font-weight: 600; border: 1px solid rgba(255,255,255,0.1); cursor: pointer; }
        .service-item.selected { background: var(--primary-color); color: white; border-color: var(--primary-color); }
        .business-card { background: var(--bg-card); padding: 16px; border-radius: 16px; margin-bottom: 12px; cursor: pointer; transition: 0.2s; }
        
        /* Detail Page */
        #detailPage { transform: translateY(100%); transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1); display: flex !important; flex-direction: column; z-index: 100; padding: 0; }
        #detailPage.active { transform: translateY(0); }
        .detail-header-img { height: 120px; background: var(--primary-gradient); position: relative; flex-shrink: 0; }
        .detail-nav { position: absolute; top: var(--safe-top); left: 0; right: 0; padding: 12px 20px; display: flex; justify-content: space-between; }
        
        /* íŒ¨ë”© ì¡°ì •: í•˜ë‹¨ ë²„íŠ¼ì— ê°€ë ¤ì§€ì§€ ì•Šë„ë¡ padding-bottomì„ ë„‰ë„‰íˆ ì¤Œ */
        .detail-content { flex: 1; background: var(--bg-dark); margin-top: -24px; border-radius: 24px 24px 0 0; position: relative; padding: 24px 20px 160px; overflow-y: auto; }
        
        .detail-name { font-size: 26px; font-weight: 800; color: white; margin-bottom: 8px; }
        .info-group { background: var(--bg-card); border-radius: 16px; padding: 20px; margin-bottom: 20px; }
        .info-item { display: flex; gap: 16px; margin-bottom: 16px; }
        .info-icon { color: var(--text-sub); width: 24px; }
        .info-text { flex: 1; color: var(--text-main); font-size: 15px; }
        
        /* [ìˆ˜ì •] í•˜ë‹¨ ë²„íŠ¼ ì˜ì—­ ìŠ¤íƒ€ì¼ ë³€ê²½ */
        .floating-bottom { 
            position: absolute; 
            bottom: 0; 
            left: 0; 
            right: 0; 
            /* í•˜ë‹¨ íŒ¨ë”©ì„ ë„‰ë„‰í•˜ê²Œ ì£¼ì–´ ë²„íŠ¼ì„ ìœ„ë¡œ ì˜¬ë¦¼ (ê¸°ë³¸ 30px + safe-area) */
            padding: 24px 20px calc(30px + env(safe-area-inset-bottom)); 
            background: #0f172a; /* ë°°ê²½ìƒ‰ì„ í™•ì‹¤í•˜ê²Œ ì£¼ì–´ ê²¹ì¹¨ ë°©ì§€ */
            border-top: 1px solid rgba(255,255,255,0.05);
            display: flex; 
            gap: 12px; 
            z-index: 50;
        }
        .action-btn { flex: 1; height: 56px; border-radius: 16px; font-weight: 700; display: flex; align-items: center; justify-content: center; gap: 8px; text-decoration: none; border:none; cursor: pointer; transition: 0.2s;}
        .action-btn.primary { background: var(--primary-color); color: white; }
        .action-btn.secondary { background: rgba(255,255,255,0.1); color: white; }

        /* SOS Page Specific Styles */
        #sosPage { z-index: 110; } 
        .sos-header { border-bottom: 1px solid rgba(239, 68, 68, 0.2); }
        .sos-title { color: #fca5a5; font-size: 14px; font-weight: 700; display: flex; align-items: center; gap:6px; }
        .sos-container { padding: 20px; }
        .sos-search-box { position: relative; margin-bottom: 24px; }
        .sos-input { width: 100%; padding: 16px 16px 16px 45px; background: #1e293b; border: 1px solid #ef4444; border-radius: 14px; color: white; font-size: 16px; outline: none; transition: 0.2s; }
        .sos-input:focus { box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.25); background: #252f45; }
        .sos-icon { position: absolute; left: 16px; top: 50%; transform: translateY(-50%); color: #f87171; }
        
        .sos-list-group-title { font-size: 13px; font-weight: 600; color: #94a3b8; margin-bottom: 12px; padding-left: 4px; }
        .sos-list-item { background: #1e293b; padding: 18px; border-radius: 16px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center; cursor: pointer; border: 1px solid rgba(255,255,255,0.05); transition: 0.2s; }
        .sos-list-item:active { background: rgba(239, 68, 68, 0.1); border-color: #ef4444; transform: scale(0.98); }
        .sos-country { font-size: 16px; font-weight: 700; color: white; }
        .sos-city { font-size: 13px; color: #94a3b8; margin-left: 6px; }
        .sos-arrow { color: #ef4444; }

        /* SOS Modal Styles */
        .sos-sheet-content { text-align: center; }
        .sos-flag { font-size: 40px; margin-bottom: 16px; display: block; }
        .sos-sheet-title { font-size: 22px; font-weight: 800; color: white; margin-bottom: 8px; }
        .sos-sheet-desc { color: #94a3b8; font-size: 14px; margin-bottom: 30px; }
        .sos-sheet-btn { background: #ef4444; color: white; width: 100%; padding: 20px; border-radius: 16px; font-size: 18px; font-weight: 800; border: none; display: flex; align-items: center; justify-content: center; gap: 10px; text-decoration: none; cursor: pointer; box-shadow: 0 4px 15px rgba(239, 68, 68, 0.4); margin-bottom: 12px; }
        .sos-sheet-btn:active { transform: scale(0.96); }

        /* Loader & Footer */
        .loading-overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(15, 23, 42, 0.8); backdrop-filter: blur(5px); display: none; align-items: center; justify-content: center; z-index: 9999; }
        .loading-overlay.show { display: flex; }
        .spinner { width: 40px; height: 40px; border: 3px solid rgba(255,255,255,0.1); border-top-color: var(--primary-color); border-radius: 50%; animation: spin 0.8s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
        .skeleton-loader { background: linear-gradient(90deg, #1e293b 25%, #334155 50%, #1e293b 75%); background-size: 200% 100%; animation: loading 1.5s infinite; border-radius: 16px; min-width: 200px; height: 80px; flex-shrink: 0; }
        @keyframes loading { 0% { background-position: 200% 0; } 100% { background-position: -200% 0; } }

        .app-footer { padding: 40px 20px calc(80px + var(--safe-bottom)) 20px; text-align: center; border-top: 1px solid rgba(255,255,255,0.05); margin-top: 40px; }
        .footer-logo { font-weight: 800; font-size: 16px; color: var(--text-sub); margin-bottom: 12px; }
        .footer-info { font-size: 11px; color: #64748b; line-height: 1.6; margin-bottom: 16px; word-break: keep-all;}
        .footer-links { display: flex; justify-content: center; gap: 16px; margin-bottom: 20px; flex-wrap: wrap; }
        .footer-link-item { font-size: 12px; color: var(--text-sub); cursor: pointer; text-decoration: underline; text-underline-offset: 4px; }

        /* [MODIFIED] Floating Action Button for SOS */
        .fab-sos { 
            position: fixed; 
            bottom: calc(20px + var(--safe-bottom)); 
            right: 20px; 
            width: 56px; height: 56px; 
            background: var(--sos-gradient); /* ë¹¨ê°„ìƒ‰ ê·¸ë¼ë””ì–¸íŠ¸ */
            border-radius: 50%; 
            display: flex; align-items: center; justify-content: center; 
            color: white; 
            box-shadow: 0 4px 15px rgba(239, 68, 68, 0.5); 
            z-index: 900; 
            cursor: pointer; 
            transition: transform 0.2s; 
            border: none; 
            animation: heartBeat 2s infinite; 
        }
        .fab-sos:active { transform: scale(0.95); }
        .fab-icon { font-size: 28px; }

        @keyframes heartBeat {
            0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7); }
            70% { transform: scale(1.05); box-shadow: 0 0 0 10px rgba(239, 68, 68, 0); }
            100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); }
        }

        /* Modal Base */
        .modal-overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); backdrop-filter: blur(5px); z-index: 2000; display: none; align-items: center; justify-content: center; opacity: 0; transition: opacity 0.3s; }
        .modal-overlay.open { display: flex; opacity: 1; }
        .modal-box { width: 90%; max-width: 500px; background: var(--bg-card); border-radius: 20px; border: 1px solid rgba(255,255,255,0.1); overflow: hidden; display: flex; flex-direction: column; max-height: 80vh; transform: scale(0.9); transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1); }
        .modal-overlay.open .modal-box { transform: scale(1); }
        .modal-header { padding: 20px; border-bottom: 1px solid rgba(255,255,255,0.05); display: flex; justify-content: space-between; align-items: center; }
        .modal-title { font-size: 18px; font-weight: 700; color: white; }
        .modal-close { color: var(--text-sub); cursor: pointer; }
        .modal-body { padding: 24px 20px; overflow-y: auto; font-size: 14px; color: var(--text-sub); line-height: 1.6; white-space: pre-line; }

        /* Inquiry Specific */
        .inquiry-options { display: flex; flex-direction: column; gap: 12px; }
        .inquiry-btn { width: 100%; padding: 16px; border-radius: 14px; font-weight: 700; display: flex; align-items: center; justify-content: center; gap: 10px; cursor: pointer; border: none; font-size: 15px; }
        .btn-email { background: var(--primary-color); color: white; }
        .btn-copy { background: rgba(255,255,255,0.1); color: white; }

        .toast-msg { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: rgba(0,0,0,0.8); color: white; padding: 12px 24px; border-radius: 30px; font-size: 14px; z-index: 3000; display: none; pointer-events: none; animation: fadeInOut 2s ease forwards; }
        @keyframes fadeInOut { 0% { opacity:0; } 10% { opacity:1; } 90% { opacity:1; } 100% { opacity:0; } }

        /* Install Banner */
        .install-banner { position: fixed; bottom: 20px; left: 20px; right: 20px; background: rgba(30, 41, 59, 0.95); border: 1px solid rgba(255,255,255,0.1); border-radius: 16px; padding: 16px; display: none; align-items: center; justify-content: space-between; box-shadow: 0 10px 25px rgba(0,0,0,0.5); z-index: 9999; backdrop-filter: blur(10px); animation: slideUp 0.5s ease; }
        @keyframes slideUp { from { transform: translateY(100px); opacity:0; } to { transform: translateY(0); opacity:1; } }
        .install-text { color: white; font-size: 14px; font-weight: 600; }
        .install-action { background: var(--primary-color); color: white; border: none; padding: 8px 16px; border-radius: 8px; font-weight: 700; font-size: 13px; cursor: pointer; }
        .install-close { color: #94a3b8; font-size: 20px; cursor: pointer; margin-left: 12px; }

        /* Desktop */
        @media (min-width: 768px) {
            .app-container { max-width: 1024px; margin: 0 auto; box-shadow: 0 0 50px rgba(0,0,0,0.5); min-height: 100vh; border: 1px solid rgba(255,255,255,0.05); }
            /* ë°ìŠ¤í¬íƒ‘ì—ì„œë„ auto-fillë¡œ ìì—°ìŠ¤ëŸ½ê²Œ ë°°ì¹˜ */
            .category-grid { grid-template-columns: repeat(auto-fill, minmax(80px, 1fr)); }
            .modern-menu-grid { grid-template-columns: repeat(4, 1fr); }
            .h-scroll-view { flex-wrap: wrap; overflow-x: visible; padding-right: 0; margin-right: 0; }
            .biz-card-sm { width: calc(33.333% - 11px); min-width: auto; }
            #detailPage.active { transform: translate(-50%, -50%); top: 50%; left: 50%; width: 600px; height: 80vh; border-radius: 24px; box-shadow: 0 20px 60px rgba(0,0,0,0.8); border: 1px solid rgba(255,255,255,0.1); overflow: hidden; }
            .detail-content { margin-top: 0; padding-top: 24px; }
            .detail-header-img { height: 160px; }
            .floating-bottom { position: absolute; border-radius: 0 0 24px 24px; bottom: 0; }
            #detailPage.active::before { content: ''; position: fixed; top: -50vh; left: -50vw; width: 200vw; height: 200vh; background: rgba(0,0,0,0.6); z-index: -1; backdrop-filter: blur(4px); pointer-events: all; cursor: pointer; }
            .fab-sos { right: calc(50% - 490px); }
            .install-banner { width: 400px; left: 50%; transform: translateX(-50%); animation: slideUpDesktop 0.5s ease; }
            @keyframes slideUpDesktop { from { transform: translate(-50%, 100px); opacity:0; } to { transform: translate(-50%, 0); opacity:1; } }
        }
        
        /* Intro Styles (FIXED FOR IPHONE NOTCH & SCROLL) */
        #introPage { background-color: #F8FAFC !important; color: #0F172A; z-index: 200; }
        .intro-nav { 
            position: fixed; 
            top: 0; left: 0; right: 0; 
            height: calc(60px + env(safe-area-inset-top)); 
            padding-top: env(safe-area-inset-top);
            display: flex; align-items: center; justify-content: space-between; 
            padding-left: 20px; padding-right: 20px;
            background: rgba(255, 255, 255, 0.85); 
            backdrop-filter: blur(12px); 
            z-index: 1000; 
            border-bottom: 1px solid rgba(0,0,0,0.05); 
        }
        .bg-mesh { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; background: radial-gradient(at 0% 0%, rgba(59, 130, 246, 0.15) 0px, transparent 50%), radial-gradient(at 100% 0%, rgba(244, 63, 94, 0.15) 0px, transparent 50%); filter: blur(40px); }
        .hero { padding: 100px 0 60px; text-align: center; }
        .section-eyebrow { font-size: 13px; font-weight: 800; color: #3B82F6; text-transform: uppercase; letter-spacing: 0.08em; display: block; margin-bottom: 12px; }
        .text-gradient { background: linear-gradient(135deg, #3B82F6 0%, #8B5CF6 50%, #F43F5E 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .intro-card { background: rgba(255, 255, 255, 0.7); backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.6); border-radius: 20px; padding: 24px; margin-bottom: 16px; }
        .btn-primary { display: inline-flex; align-items: center; justify-content: center; padding: 16px 32px; font-size: 17px; font-weight: 700; color: white; background: linear-gradient(135deg, #3B82F6 0%, #F43F5E 100%); border-radius: 14px; text-decoration: none; box-shadow: 0 10px 20px -5px rgba(59, 130, 246, 0.4); }
    </style>
</head>
<body>
    <div class="loading-overlay" id="loadingOverlay"><div class="spinner"></div></div>
    
    <div id="toast" class="toast-msg">ì´ë©”ì¼ ì£¼ì†Œê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.</div>

    <div class="app-container">
        
        <div class="page active" id="mainPage">
            <header class="app-header">
                <div class="header-brand">
                    <img src="https://drive.google.com/thumbnail?id=1FoWG_L4oKEw-FDk6-kO6KY_6E8rU_mig&sz=w1000" class="header-brand-img" alt="Kornect Logo">
                    <span class="header-brand-slogan">í•´ì™¸ í•œì¸ ìƒí™œì˜ ëª¨ë“  ê²ƒì„ ì—°ê²°í•©ë‹ˆë‹¤</span>
                </div>
                <div class="header-actions">
                    <button class="btn-circle" onclick="showPage('introPage')" title="ì„œë¹„ìŠ¤ ì†Œê°œ">
                        <span class="material-icons-round">info</span>
                    </button>
                </div>
            </header>

            <div class="content-container">
                <a href="https://kornect.kr/join" target="_blank" class="banner-card">
                    <div class="banner-content">
                        <span class="banner-title">ë¹„ì¦ˆë‹ˆìŠ¤ ë¬´ë£Œ ë“±ë¡</span>
                        <span class="banner-desc">ì „ ì„¸ê³„ í•œì¸ë“¤ì—ê²Œ í™ë³´í•˜ì„¸ìš”!</span>
                    </div>
                    <span class="material-icons-round banner-icon">storefront</span>
                </a>

                <div class="stats">
                    <div class="stat-card"><div class="stat-number">50</div><div class="stat-label">êµ­ê°€</div></div>
                    <div class="stat-card"><div class="stat-number">340</div><div class="stat-label">ë„ì‹œ</div></div>
                    <div class="stat-card"><div class="stat-number">12,350</div><div class="stat-label">ë“±ë¡ì—…ì²´</div></div>
                </div>

                <div class="section">
                    <div class="section-header"><div class="section-title">ì—…ì²´ ê²€ìƒ‰í•˜ê¸°</div></div>
                    
                    <div class="category-grid">
                        <div class="cat-item" onclick="openCategoryURL('https://example.com/taxi')"><div class="cat-icon-box"><span class="material-icons-round">local_taxi</span></div> <div class="cat-name">í•œì¸íƒì‹œ</div></div>
                        <div class="cat-item" onclick="openCategoryURL('https://kornect.kr/minbak')"><div class="cat-icon-box"><span class="material-icons-round">hotel</span></div> <div class="cat-name">í•œì¸ìˆ™ì†Œ</div></div>
                        <div class="cat-item" onclick="openCategoryURL('https://kornect.kr/tour')"><div class="cat-icon-box"><span class="material-icons-round">flag</span></div> <div class="cat-name">íˆ¬ì–´</div></div>
                        <div class="cat-item" onclick="openCategoryURL('https://kornect.kr/restaurants')"><div class="cat-icon-box"><span class="material-icons-round">restaurant</span></div> <div class="cat-name">í•œì‹ë‹¹</div></div>
                        <div class="cat-item" onclick="openCategoryURL('https://kornect.kr/supermarket')"><div class="cat-icon-box"><span class="material-icons-round">shopping_cart</span></div> <div class="cat-name">ë§ˆíŠ¸</div></div>
                        <div class="cat-item" onclick="openCategoryURL('https://kornect.kr/beauty')"><div class="cat-icon-box"><span class="material-icons-round">content_cut</span></div> <div class="cat-name">ë·°í‹°</div></div>
                        <div class="cat-item" onclick="openCategoryURL('https://kornect.kr/law')"><div class="cat-icon-box"><span class="material-icons-round">gavel</span></div> <div class="cat-name">ë²•ë¥ /ì„¸ë¬´</div></div>
                        <div class="cat-item" onclick="openCategoryURL('https://kornect.kr/daily')"><div class="cat-icon-box"><span class="material-icons-round">build</span></div> <div class="cat-name">ìƒí™œ</div></div>
                        <div class="cat-item" onclick="openCategoryURL('https://kornect.kr/society')"><div class="cat-icon-box"><span class="material-icons-round">diversity_3</span></div> <div class="cat-name">ë™í˜¸íšŒ</div></div>
                    </div>
                </div>

                <div class="section">
                    <div class="section-header"><div class="section-title">âœ¨ ì£¼ìš” ì„œë¹„ìŠ¤</div></div>
                    <div class="modern-menu-grid">
                        <div class="modern-card" onclick="openCategoryURL('https://kornect.kr/ticket')"><div class="modern-icon theme-orange"><span class="material-icons-round">auto_stories</span></div><div class="modern-card-text"><div class="modern-card-title">ìµœì €ê°€ í‹°ì¼“</div><div class="modern-card-desc">ì—¬í–‰ ì¤€ë¹„ í•„ìˆ˜ ì •ë³´</div></div></div>
                        <div class="modern-card" onclick="openCategoryURL('https://kornect.kr/used-market')"><div class="modern-icon theme-indigo"><span class="material-icons-round">storefront</span></div><div class="modern-card-text"><div class="modern-card-title">ì¤‘ê³ ê±°ë˜ ì¥í„°</div><div class="modern-card-desc">êµë¯¼ ê°„ ì•ˆì „í•œ ê±°ë˜</div></div></div>
                        <div class="modern-card" onclick="openCategoryURL('https://kornect.kr/shopping')"><div class="modern-icon theme-pink"><span class="material-icons-round">local_fire_department</span></div><div class="modern-card-text"><div class="modern-card-title">í˜„ì§€ í•«í…œ ì •ë³´</div><div class="modern-card-desc">ì§€ê¸ˆ ëœ¨ëŠ” ì•„ì´í…œì€?</div></div></div>
                        <div class="modern-card" onclick="openCategoryURL('https://kornect.kr/freelancer')"><div class="modern-icon theme-blue"><span class="material-icons-round">laptop_mac</span></div><div class="modern-card-text"><div class="modern-card-title">K-í”„ë¦¬ëœì„œ ë§ˆì¼“</div><div class="modern-card-desc">ì „ë¬¸ê°€ ì¬ëŠ¥ ë§ˆì¼“</div></div></div>
                        <div class="modern-card" onclick="openCategoryURL('https://kornect.kr/faq')"><div class="modern-icon theme-teal"><span class="material-icons-round">map</span></div><div class="modern-card-text"><div class="modern-card-title">ì—¬í–‰ì •ë³´ ë¡œë“œë§µ</div><div class="modern-card-desc">ìì£¼ ë¬»ëŠ” ì§ˆë¬¸ FAQ</div></div></div>
                        <div class="modern-card" onclick="openCategoryURL('https://kornect.kr/k-contents')"><div class="modern-icon theme-purple"><span class="material-icons-round">play_circle</span></div><div class="modern-card-text"><div class="modern-card-title">K-ìˆí¼ íë ˆì´ì…˜</div><div class="modern-card-desc">í™”ì œì˜ ì˜ìƒ & ë‰´ìŠ¤</div></div></div>
                    </div>
                </div>
                
                <div class="section">
                    <div class="section-header"><div class="section-title">ğŸ”¥ ì¸ê¸° ë¹„ì¦ˆë‹ˆìŠ¤</div></div>
                    <div class="h-scroll-view" id="featuredList">
                        <div class="skeleton-loader"></div><div class="skeleton-loader"></div>
                    </div>
                </div>

                <div class="section">
                    <div class="section-header"><div class="section-title">âœ¨ ì‹ ê·œ ë¹„ì¦ˆë‹ˆìŠ¤</div></div>
                    <div class="h-scroll-view" id="newList">
                         <div class="skeleton-loader"></div><div class="skeleton-loader"></div>
                    </div>
                </div>

                <footer class="app-footer">
                    <div class="footer-links">
                        <span class="footer-link-item" onclick="openLegalModal('terms')">ì´ìš©ì•½ê´€</span>
                        <span style="color:#334155">|</span>
                        <span class="footer-link-item" onclick="openLegalModal('privacy')" style="font-weight:700">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</span>
                        <span style="color:#334155">|</span>
                        <span class="footer-link-item" onclick="openInquiryModal()">ë¬¸ì˜í•˜ê¸°</span>
                    </div>
                    <div class="footer-logo">Kornect</div>
                    <div class="footer-info">
                        ìƒí˜¸ëª…: Kornect (ì½”ë„¥íŠ¸) | ëŒ€í‘œì: ì‹ ì˜ì„­<br>
                        ì£¼ì†Œ: ê²½ê¸°ë„ ê´‘ëª…ì‹œ í•˜ì•ˆë¡œ 108, 521í˜¸(ì†Œí•˜ë™, ì—ì´ìŠ¤ ê´‘ëª…íƒ€ì›Œ)<br>
                        ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸: 347-02-03104 | ì´ë©”ì¼: admin@kornect.kr<br>
                        <br>
                        KornectëŠ” í†µì‹ íŒë§¤ì¤‘ê°œìë¡œì„œ ê±°ë˜ ë‹¹ì‚¬ìê°€ ì•„ë‹ˆë©°,<br>
                        ë“±ë¡ëœ ì—…ì²´ ì •ë³´ì˜ ì •í™•ì„±ì— ëŒ€í•´ ì±…ì„ì„ ì§€ì§€ ì•ŠìŠµë‹ˆë‹¤.
                    </div>
                    <div style="font-size:10px; color:#475569; margin-top:8px;">Â© 2026 Kornect. All rights reserved.</div>
                </footer>
            </div>
            
            <button class="fab-sos" onclick="sosApp.openSOS()">
                <span class="material-icons-round fab-icon">phonelink_ring</span>
            </button>
        </div>
        
        <div class="page" id="sosPage">
            <header class="app-header sos-header">
                <button class="btn-circle" onclick="goBack()"><span class="material-icons-round">arrow_back</span></button>
                <div class="sos-title"><span class="material-icons-round">emergency</span> ê¸´ê¸‰ ì˜ì‚¬ê´€ ì—°ê²°</div>
                <div style="width:40px"></div>
            </header>
            <div class="sos-container">
                <div class="sos-search-box">
                    <span class="material-icons-round sos-icon">search</span>
                    <input type="text" id="sosSearchInput" class="sos-input" placeholder="êµ­ê°€ ë˜ëŠ” ë„ì‹œ ê²€ìƒ‰ (ì˜ˆ: ì¼ë³¸)">
                </div>
                <div class="sos-list-group-title">ì§€ì› êµ­ê°€ ë° ì§€ì—­</div>
                <div id="sosListContainer">
                    </div>
            </div>
        </div>

        <div class="page" id="searchPage">
            <header class="app-header">
                <button class="btn-circle" onclick="goBack()"><span class="material-icons-round">arrow_back</span></button>
                <div style="color:white; font-weight:700;">ê²€ìƒ‰ ì„¤ì •</div>
                <div style="width:40px"></div>
            </header>
            <div class="content-container" style="padding-top: 20px;">
                <div class="section">
                    <div class="section-title" style="margin-bottom:12px;">ğŸ“ ìœ„ì¹˜ ì„ íƒ</div>
                    <div class="location-grid"><div style="color:var(--text-sub); font-size:13px;">ë¡œë”© ì¤‘...</div></div>
                </div>
                <div class="section">
                    <div class="section-title" style="margin-bottom:12px;">ğŸ” ì„œë¹„ìŠ¤ ì¹´í…Œê³ ë¦¬</div>
                    <div class="service-grid"><div style="color:var(--text-sub); font-size:13px;">ë¡œë”© ì¤‘...</div></div>
                </div>
                <button class="search-btn" onclick="doSearch()">ê²€ìƒ‰í•˜ê¸°</button>
            </div>
        </div>
        
        <div class="page" id="resultsPage">
            <header class="app-header">
                <button class="btn-circle" onclick="goBack()"><span class="material-icons-round">arrow_back</span></button>
                <div style="color:var(--text-sub); font-size:14px;"><strong id="resultLocation" style="color:var(--primary-color)"></strong>ì˜ <strong id="resultCategory" style="color:var(--primary-color)"></strong></div>
                <div style="width:40px"></div>
            </header>
            <div class="business-list" id="businessList"></div>
        </div>
        
        <div class="page" id="detailPage">
            <div class="detail-header-img">
                <div class="detail-nav">
                    <button class="btn-circle" onclick="goBack()"><span class="material-icons-round">arrow_back</span></button>
                    <button class="btn-circle"><span class="material-icons-round">share</span></button>
                </div>
            </div>
            <div class="detail-content">
                <div class="detail-name" id="detailName">...</div>
                <div style="color:#fbbf24; font-weight:700; margin-bottom:20px;">â­ <span id="detailRating">...</span></div>
                <div class="info-group">
                    <div class="info-item"><span class="material-icons-round info-icon">location_on</span><div class="info-text" id="detailAddress">...</div></div>
                    <div class="info-item"><span class="material-icons-round info-icon">call</span><div class="info-text" id="detailPhone">...</div></div>
                    <div class="info-item"><span class="material-icons-round info-icon">schedule</span><div class="info-text" id="detailHours">...</div></div>
                    <div class="info-item" id="websiteItem" style="display:none"><span class="material-icons-round info-icon">language</span><div class="info-text" id="detailWebsite">...</div></div>
                </div>
            </div>
            <div class="floating-bottom">
                <a class="action-btn secondary" id="mapBtn" target="_blank"><span class="material-icons-round">map</span> ê¸¸ì°¾ê¸°</a>
                <a class="action-btn primary" id="callBtn"><span class="material-icons-round">call</span> ì „í™”í•˜ê¸°</a>
            </div>
        </div>

        <div class="page" id="introPage">
            <div class="bg-mesh"></div>
            <nav class="intro-nav">
                <div class="intro-logo" style="font-weight:800; font-size:18px;">Kornect</div>
                <span class="material-icons-round intro-close-btn" style="font-size:24px; cursor:pointer;" onclick="goBack()">close</span>
            </nav>

            <div style="padding-top: 100px; padding-bottom: 150px; box-sizing: border-box; width: 100%;"> 
                
                <section class="hero">
                    <div class="container" style="padding:0 24px;">
                        <span class="section-eyebrow fade-in-up">GLOBAL KOREAN BUSINESS</span>
                        <h1 class="fade-in-up" style="font-size:36px; font-weight:800; line-height:1.2; margin-bottom:20px; color:#0F172A;">
                            í•œì¸ ë¹„ì¦ˆë‹ˆìŠ¤,<br><span class="text-gradient">ì„¸ìƒì— ë‹¿ë‹¤</span>
                        </h1>
                        <p class="fade-in-up" style="color:#475569; margin-bottom:32px; font-size:15px; line-height:1.6;">
                            í™ë³´ë¶€í„° ì „ ì„¸ê³„ ê³ ê° ì—°ê²°ê¹Œì§€.<br>
                            ì‚¬ì¥ë‹˜ì€ ì´ì œ <strong>ë³¸ì—…</strong>ì—ë§Œ ì§‘ì¤‘í•˜ì„¸ìš”.<br>
                            ë³µì¡í•œ ë§ˆì¼€íŒ…ì€ ì½”ë„¥íŠ¸ê°€ í•´ê²°í•©ë‹ˆë‹¤.
                        </p>
                        <a href="https://join-olive.vercel.app" class="btn-primary fade-in-up" target="_blank" style="width:100%; max-width:280px;">
                            ì§€ê¸ˆ ë¬´ë£Œë¡œ ë“±ë¡í•˜ê¸°
                        </a>
                        <div class="fade-in-up" style="margin-top:16px; font-size:12px; color:#64748b;">
                            âš¡ï¸ 1ë¶„ì´ë©´ ë“±ë¡ ì™„ë£Œ! ë³„ë„ ë¹„ìš© ì—†ìŒ
                        </div>
                    </div>
                </section>

                <div style="padding: 20px;">
                    <div style="margin-bottom:12px; font-weight:700; font-size:18px; color:#1e293b;">ì´ëŸ° ê³ ë¯¼ ìˆìœ¼ì‹ ê°€ìš”? ğŸ¤”</div>
                    
                    <div class="intro-card">
                        <div style="display:flex; gap:12px; margin-bottom:8px;">
                            <div style="width:40px; height:40px; background:rgba(59, 130, 246, 0.1); border-radius:10px; display:flex; align-items:center; justify-content:center; color:#3b82f6;">
                                <span class="material-icons-round">person_search</span>
                            </div>
                            <div>
                                <h3 style="font-size:17px; font-weight:700; color:#0f172a;">ê³ ê° í™•ë³´ì˜ ì–´ë ¤ì›€</h3>
                                <p style="font-size:13px; color:#64748b;">êµë¯¼ ì‚¬íšŒì™€ í˜„ì§€ì¸, ì—¬í–‰ê°ê¹Œì§€...<br>ëª¨ë‘ì—ê²Œ í™ë³´í•˜ê¸° ë§‰ë§‰í•˜ì…¨ì£ ?</p>
                            </div>
                        </div>
                    </div>

                    <div class="intro-card">
                        <div style="display:flex; gap:12px; margin-bottom:8px;">
                            <div style="width:40px; height:40px; background:rgba(244, 63, 94, 0.1); border-radius:10px; display:flex; align-items:center; justify-content:center; color:#f43f5e;">
                                <span class="material-icons-round">savings</span>
                            </div>
                            <div>
                                <h3 style="font-size:17px; font-weight:700; color:#0f172a;">ë¶€ë‹´ìŠ¤ëŸ¬ìš´ ë§ˆì¼€íŒ… ë¹„ìš©</h3>
                                <p style="font-size:13px; color:#64748b;">íš¨ê³¼ë¥¼ ì•Œ ìˆ˜ ì—†ëŠ” ë¹„ì‹¼ ê´‘ê³ ë¹„,<br>ì´ì œ ë¬´ë£Œ í”Œë«í¼ìœ¼ë¡œ í•´ê²°í•˜ì„¸ìš”.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div style="padding: 0 24px 40px;">
                    <div style="margin-bottom:20px; font-weight:700; font-size:18px; color:#1e293b;">KornectëŠ” ë‹¤ë¦…ë‹ˆë‹¤ âœ¨</div>
                    
                    <div style="display:grid; grid-template-columns: 1fr 1fr; gap:16px;">
                        <div style="background:white; padding:16px; border-radius:16px; border:1px solid #e2e8f0; text-align:center;">
                            <span class="material-icons-round" style="font-size:32px; color:#6366f1; margin-bottom:8px;">public</span>
                            <div style="font-weight:700; font-size:14px; margin-bottom:4px;">ê¸€ë¡œë²Œ ë…¸ì¶œ</div>
                            <div style="font-size:11px; color:#64748b;">ì „ ì„¸ê³„ ì–´ë””ì„œë“ <br>ë‚´ ê°€ê²Œ ê²€ìƒ‰ ê°€ëŠ¥</div>
                        </div>
                        <div style="background:white; padding:16px; border-radius:16px; border:1px solid #e2e8f0; text-align:center;">
                            <span class="material-icons-round" style="font-size:32px; color:#8b5cf6; margin-bottom:8px;">phonelink_setup</span>
                            <div style="font-weight:700; font-size:14px; margin-bottom:4px;">ì•± ì„¤ì¹˜ ë¶ˆí•„ìš”</div>
                            <div style="font-size:11px; color:#64748b;">ì›¹ìœ¼ë¡œ ì¦‰ì‹œ ì ‘ì†<br>ì ‘ê·¼ì„± 100%</div>
                        </div>
                        <div style="background:white; padding:16px; border-radius:16px; border:1px solid #e2e8f0; text-align:center;">
                            <span class="material-icons-round" style="font-size:32px; color:#ec4899; margin-bottom:8px;">edit_note</span>
                            <div style="font-weight:700; font-size:14px; margin-bottom:4px;">ê°„í¸í•œ ê´€ë¦¬</div>
                            <div style="font-size:11px; color:#64748b;">ì˜ì—…ì‹œê°„, ë©”ë‰´ ë“±<br>ì–¸ì œë“  ìˆ˜ì • ê°€ëŠ¥</div>
                        </div>
                        <div style="background:white; padding:16px; border-radius:16px; border:1px solid #e2e8f0; text-align:center;">
                            <span class="material-icons-round" style="font-size:32px; color:#10b981; margin-bottom:8px;">verified</span>
                            <div style="font-weight:700; font-size:14px; margin-bottom:4px;">ì‹ ë¢°ë„ ìƒìŠ¹</div>
                            <div style="font-size:11px; color:#64748b;">ë¦¬ë·°ì™€ í‰ì ìœ¼ë¡œ<br>ê³ ê° ì‹ ë¢° í™•ë³´</div>
                        </div>
                    </div>
                </div>

                <div style="background:#f1f5f9; padding: 30px 24px; border-radius:24px; margin: 0 20px;">
                    <div style="text-align:center; margin-bottom:24px;">
                        <h3 style="font-size:18px; font-weight:800; color:#0f172a;">ğŸš€ ì‹œì‘í•˜ëŠ” ë°©ë²•</h3>
                        <p style="font-size:13px; color:#64748b;">ì•„ì£¼ ê°„ë‹¨í•©ë‹ˆë‹¤. 3ë‹¨ê³„ë§Œ ê±°ì¹˜ì„¸ìš”.</p>
                    </div>

                    <div style="display:flex; flex-direction:column; gap:20px;">
                        <div style="display:flex; align-items:center; gap:16px;">
                            <div style="width:32px; height:32px; background:#0f172a; color:white; border-radius:50%; display:flex; align-items:center; justify-content:center; font-weight:700; flex-shrink:0;">1</div>
                            <div style="font-size:14px; color:#334155;"><strong>'ë¬´ë£Œë¡œ ë“±ë¡í•˜ê¸°'</strong> ë²„íŠ¼ í´ë¦­</div>
                        </div>
                        <div style="height:20px; border-left:2px dashed #cbd5e1; margin:-10px 0 -10px 15px;"></div>
                        <div style="display:flex; align-items:center; gap:16px;">
                            <div style="width:32px; height:32px; background:#0f172a; color:white; border-radius:50%; display:flex; align-items:center; justify-content:center; font-weight:700; flex-shrink:0;">2</div>
                            <div style="font-size:14px; color:#334155;">ë¹„ì¦ˆë‹ˆìŠ¤ ì •ë³´(ì´ë¦„, ìœ„ì¹˜ ë“±) ì…ë ¥</div>
                        </div>
                        <div style="height:20px; border-left:2px dashed #cbd5e1; margin:-10px 0 -10px 15px;"></div>
                        <div style="display:flex; align-items:center; gap:16px;">
                            <div style="width:32px; height:32px; background:#6366f1; color:white; border-radius:50%; display:flex; align-items:center; justify-content:center; font-weight:700; flex-shrink:0;">3</div>
                            <div style="font-size:14px; color:#334155;"><strong>ë“±ë¡ ì™„ë£Œ!</strong> ì¦‰ì‹œ í™ë³´ê°€ ì‹œì‘ë©ë‹ˆë‹¤.</div>
                        </div>
                    </div>
                </div>

                <div style="padding: 40px 24px 20px; text-align:center;">
                    <h2 style="font-size:22px; font-weight:800; color:#0f172a; margin-bottom:12px;">ì§€ê¸ˆ ë°”ë¡œ ì‹œì‘í•˜ì„¸ìš”</h2>
                    <p style="font-size:14px; color:#64748b; margin-bottom:24px;">ì´ë¯¸ ì „ ì„¸ê³„ 12,000ê°œ ì´ìƒì˜ í•œì¸ ë¹„ì¦ˆë‹ˆìŠ¤ê°€<br>Kornectì™€ í•¨ê»˜ ì„±ì¥í•˜ê³  ìˆìŠµë‹ˆë‹¤.</p>
                    <a href="https://join-olive.vercel.app" class="btn-primary" target="_blank" style="width:100%; box-shadow: 0 10px 30px rgba(99, 102, 241, 0.3);">
                        ë‚´ ë¹„ì¦ˆë‹ˆìŠ¤ ë¬´ë£Œ ë“±ë¡í•˜ê¸°
                    </a>
                </div>

            </div>
        </div>
    </div>
    
    <div class="modal-overlay" id="sosModal">
        <div class="modal-box">
            <div class="modal-header">
                <span class="modal-title" style="color:#ef4444">ğŸš¨ ê¸´ê¸‰ ì—°ê²°</span>
                <span class="material-icons-round modal-close" onclick="sosApp.closeSOSModal()">close</span>
            </div>
            <div class="modal-body sos-sheet-content">
                <span class="sos-flag" id="sosModalFlag">ğŸ‡°ğŸ‡·</span>
                <div class="sos-sheet-title" id="sosModalTitle">êµ­ê°€ëª…</div>
                <div class="sos-sheet-desc" id="sosModalDesc">ê´€í•  ì˜ì‚¬ê´€ìœ¼ë¡œ ì¦‰ì‹œ ì—°ê²°í•©ë‹ˆë‹¤.</div>
                <a href="#" class="sos-sheet-btn" id="sosCallBtn">
                    <span class="material-icons-round">call</span> ì „í™” ì—°ê²°
                </a>
                <div style="font-size:12px; color:#64748b; margin-top:10px;">
                    â€» í†µí™”ë£Œê°€ ë¶€ê³¼ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                </div>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="inquiryModal">
        <div class="modal-box">
            <div class="modal-header">
                <span class="modal-title">ë¬¸ì˜ ë° ì œíœ´</span>
                <span class="material-icons-round modal-close" onclick="closeModals()">close</span>
            </div>
            <div class="modal-body" style="text-align:center; padding-bottom:30px;">
                <p style="margin-bottom:20px;">Kornect ì„œë¹„ìŠ¤ ì´ìš© ë¬¸ì˜ë‚˜<br>ì œíœ´ ì œì•ˆì€ ì´ë©”ì¼ë¡œ ë³´ë‚´ì£¼ì„¸ìš”.</p>
                <div class="inquiry-options">
                    <button class="inquiry-btn btn-email" onclick="location.href='mailto:admin@kornect.kr'">
                        <span class="material-icons-round">send</span> ì´ë©”ì¼ ì•± ì—´ê¸°
                    </button>
                    <button class="inquiry-btn btn-copy" onclick="copyEmail()">
                        <span class="material-icons-round">content_copy</span> ì£¼ì†Œ ë³µì‚¬í•˜ê¸°
                    </button>
                </div>
                <div style="margin-top:16px; font-size:13px; color:#64748b;">admin@kornect.kr</div>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="termsModal">
        <div class="modal-box">
            <div class="modal-header">
                <span class="modal-title">ì´ìš©ì•½ê´€</span>
                <span class="material-icons-round modal-close" onclick="closeModals()">close</span>
            </div>
            <div class="modal-body">
                <strong>ì œ1ì¡° (ëª©ì )</strong>
                ë³¸ ì•½ê´€ì€ Kornect(ì´í•˜ "íšŒì‚¬")ê°€ ì œê³µí•˜ëŠ” í•œì¸ ë¹„ì¦ˆë‹ˆìŠ¤ ì •ë³´ ì œê³µ ì„œë¹„ìŠ¤(ì´í•˜ "ì„œë¹„ìŠ¤")ì˜ ì´ìš©ê³¼ ê´€ë ¨í•˜ì—¬ íšŒì‚¬ì™€ íšŒì›ì˜ ê¶Œë¦¬, ì˜ë¬´ ë° ì±…ì„ì‚¬í•­ì„ ê·œì •í•¨ì„ ëª©ì ìœ¼ë¡œ í•©ë‹ˆë‹¤.
                <br><br>
                </div>
        </div>
    </div>

    <div class="modal-overlay" id="privacyModal">
        <div class="modal-box">
            <div class="modal-header">
                <span class="modal-title">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</span>
                <span class="material-icons-round modal-close" onclick="closeModals()">close</span>
            </div>
            <div class="modal-body">
                <strong>1. ê°œì¸ì •ë³´ ìˆ˜ì§‘ í•­ëª©</strong>
                KornectëŠ” ë³„ë„ì˜ íšŒì›ê°€ì… ì—†ì´ ì´ìš© ê°€ëŠ¥í•˜ë©°, ì„œë¹„ìŠ¤ ì œê³µì„ ìœ„í•´ ìµœì†Œí•œì˜ ì •ë³´ë¥¼ ìˆ˜ì§‘í•©ë‹ˆë‹¤.
                <br><br>
                </div>
        </div>
    </div>
    
    <div id="installBanner" class="install-banner">
        <div style="display:flex; align-items:center; gap:12px;">
            <img src="Kornect Logo 192X192.png" style="width:40px; height:40px; border-radius:8px;">
            <div class="install-text">ì•±ìœ¼ë¡œ ë” í¸í•˜ê²Œ ì´ìš©í•˜ì„¸ìš”!<br><span style="font-size:11px; color:#94a3b8; font-weight:400;">ë¹ ë¥¸ ì ‘ì† ë° ì•Œë¦¼ ê¸°ëŠ¥ ì œê³µ</span></div>
        </div>
        <div style="display:flex; align-items:center;">
            <button class="install-action" onclick="installPWA()">ì„¤ì¹˜</button>
            <span class="material-icons-round install-close" onclick="closeInstallBanner()">close</span>
        </div>
    </div>
    
    <script>
    // Service Worker Registration
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
            navigator.serviceWorker.register('./service-worker.js')
                .then(reg => console.log('SW Registered', reg))
                .catch(err => console.log('SW Fail', err));
        });
    }

    (function() {
        'use strict';
        const GAS_WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbzN8mtYeMS2JRIABZ0Mkm6CAwDM0UOOdah6mmakuiYlh0Oa6p1enjrZJiYD6PhuwmqoKw/exec';
        
        // Define sosApp INSIDE the IIFE to ensure it can access showPage safely
        const sosApp = {
            data: [
                { country: 'ê´Œ', city: 'í•˜ê°“ëƒ', phone: '+1-671-647-6488', flag: 'ğŸ‡¬ğŸ‡º' },
                { country: 'ê·¸ë¦¬ìŠ¤', city: 'ì•„í…Œë„¤', phone: '+30-210-698-4080', flag: 'ğŸ‡¬ğŸ‡·' },
                { country: 'ë‚¨ì•„ê³µ', city: 'í”„ë¦¬í† ë¦¬ì•„', phone: '+27-12-460-2508', flag: 'ğŸ‡¿ğŸ‡¦' },
                { country: 'ë„¤ëœë€ë“œ', city: 'í—¤ì´ê·¸', phone: '+31-70-740-0214', flag: 'ğŸ‡³ğŸ‡±' },
                { country: 'ëŒ€ë§Œ', city: 'íƒ€ì´ë² ì´', phone: '+886-2-2758-8320', flag: 'ğŸ‡¹ğŸ‡¼' },
                { country: 'ë…ì¼', city: 'ë² ë¥¼ë¦°', phone: '+49-30-260-650', flag: 'ğŸ‡©ğŸ‡ª' },
                { country: 'ë…ì¼', city: 'í”„ë‘í¬í‘¸ë¥´íŠ¸', phone: '+49-69-956-7520', flag: 'ğŸ‡©ğŸ‡ª' },
                { country: 'ë¼ì˜¤ìŠ¤', city: 'ë¹„ì—”í‹°ì•ˆ', phone: '+856-21-352-031', flag: 'ğŸ‡±ğŸ‡¦' },
                { country: 'ëŸ¬ì‹œì•„', city: 'ëª¨ìŠ¤í¬ë°”', phone: '+7-495-783-2727', flag: 'ğŸ‡·ğŸ‡º' },
                { country: 'ëŸ¬ì‹œì•„', city: 'ë¸”ë¼ë””ë³´ìŠ¤í†¡', phone: '+7-423-240-2222', flag: 'ğŸ‡·ğŸ‡º' },
                { country: 'ë§ë ˆì´ì‹œì•„', city: 'ì¿ ì•Œë¼ë£¸í‘¸ë¥´', phone: '+60-3-4251-2336', flag: 'ğŸ‡²ğŸ‡¾' },
                { country: 'ë©•ì‹œì½”', city: 'ë©•ì‹œì½”ì‹œí‹°', phone: '+52-55-5202-9866', flag: 'ğŸ‡²ğŸ‡½' },
                { country: 'ëª½ê³¨', city: 'ìš¸ë€ë°”í† ë¥´', phone: '+976-7007-1020', flag: 'ğŸ‡²ğŸ‡³' },
                { country: 'ë¯¸êµ­', city: 'ì›Œì‹±í„´', phone: '+1-202-939-5654', flag: 'ğŸ‡ºğŸ‡¸' },
                { country: 'ë¯¸êµ­', city: 'ë‰´ìš•', phone: '+1-646-674-1600', flag: 'ğŸ‡ºğŸ‡¸' },
                { country: 'ë¯¸êµ­', city: 'LA', phone: '+1-213-385-9300', flag: 'ğŸ‡ºğŸ‡¸' },
                { country: 'ë¯¸êµ­', city: 'ìƒŒí”„ë€ì‹œìŠ¤ì½”', phone: '+1-415-921-2251', flag: 'ğŸ‡ºğŸ‡¸' },
                { country: 'ë¯¸êµ­', city: 'í•˜ì™€ì´', phone: '+1-808-595-6109', flag: 'ğŸ‡ºğŸ‡¸' },
                { country: 'ë² íŠ¸ë‚¨', city: 'í•˜ë…¸ì´', phone: '+84-90-402-6126', flag: 'ğŸ‡»ğŸ‡³' },
                { country: 'ë² íŠ¸ë‚¨', city: 'í˜¸ì¹˜ë¯¼', phone: '+84-93-850-0238', flag: 'ğŸ‡»ğŸ‡³' },
                { country: 'ë² íŠ¸ë‚¨', city: 'ë‹¤ë‚­', phone: '+84-93-246-5036', flag: 'ğŸ‡»ğŸ‡³' },
                { country: 'ë²¨ê¸°ì—', city: 'ë¸Œë¤¼ì…€', phone: '+32-2-675-5777', flag: 'ğŸ‡§ğŸ‡ª' },
                { country: 'ë¸Œë¼ì§ˆ', city: 'ìƒíŒŒìš¸ë£¨', phone: '+55-11-3141-1278', flag: 'ğŸ‡§ğŸ‡·' },
                { country: 'ì‚¬ì´íŒ', city: 'ì‚¬ì´íŒ', phone: '+1-670-234-0422', flag: 'ğŸ‡²ğŸ‡µ' },
                { country: 'ìŠ¤ìœ„ìŠ¤', city: 'ë² ë¥¸', phone: '+41-31-356-2444', flag: 'ğŸ‡¨ğŸ‡­' },
                { country: 'ìŠ¤í˜ì¸', city: 'ë§ˆë“œë¦¬ë“œ', phone: '+34-91-353-2000', flag: 'ğŸ‡ªğŸ‡¸' },
                { country: 'ìŠ¤í˜ì¸', city: 'ë°”ë¥´ì…€ë¡œë‚˜', phone: '+34-93-487-3153', flag: 'ğŸ‡ªğŸ‡¸' },
                { country: 'ì‹±ê°€í¬ë¥´', city: 'ì‹±ê°€í¬ë¥´', phone: '+65-6256-1188', flag: 'ğŸ‡¸ğŸ‡¬' },
                { country: 'ì•„ëì—ë¯¸ë¦¬íŠ¸', city: 'ë‘ë°”ì´', phone: '+971-4-344-9200', flag: 'ğŸ‡¦ğŸ‡ª' },
                { country: 'ì•„ë¥´í—¨í‹°ë‚˜', city: 'ë¶€ì—ë…¸ìŠ¤ì•„ì´ë ˆìŠ¤', phone: '+54-11-4802-8865', flag: 'ğŸ‡¦ğŸ‡·' },
                { country: 'ì˜êµ­', city: 'ëŸ°ë˜', phone: '+44-78-7650-6895', flag: 'ğŸ‡¬ğŸ‡§' },
                { country: 'ì˜¤ìŠ¤íŠ¸ë¦¬ì•„', city: 'ë¹ˆ', phone: '+43-1-478-1991', flag: 'ğŸ‡¦ğŸ‡¹' },
                { country: 'ì´íƒˆë¦¬ì•„', city: 'ë¡œë§ˆ', phone: '+39-06-802461', flag: 'ğŸ‡®ğŸ‡¹' },
                { country: 'ì´íƒˆë¦¬ì•„', city: 'ë°€ë¼ë…¸', phone: '+39-02-2906-2641', flag: 'ğŸ‡®ğŸ‡¹' },
                { country: 'ì¸ë„', city: 'ë‰´ë¸ë¦¬', phone: '+91-11-4200-7000', flag: 'ğŸ‡®ğŸ‡³' },
                { country: 'ì¸ë„ë„¤ì‹œì•„', city: 'ìì¹´ë¥´íƒ€', phone: '+62-21-2967-2580', flag: 'ğŸ‡®ğŸ‡©' },
                { country: 'ì¸ë„ë„¤ì‹œì•„', city: 'ë°œë¦¬', phone: '+62-811-386-7357', flag: 'ğŸ‡®ğŸ‡©' },
                { country: 'ì¼ë³¸', city: 'ë„ì¿„', phone: '+81-3-3452-7611', flag: 'ğŸ‡¯ğŸ‡µ' },
                { country: 'ì¼ë³¸', city: 'ì˜¤ì‚¬ì¹´', phone: '+81-90-3050-0746', flag: 'ğŸ‡¯ğŸ‡µ' },
                { country: 'ì¼ë³¸', city: 'í›„ì¿ ì˜¤ì¹´', phone: '+81-92-771-0461', flag: 'ğŸ‡¯ğŸ‡µ' },
                { country: 'ì¼ë³¸', city: 'ì‚¿í¬ë¡œ', phone: '+81-11-218-0288', flag: 'ğŸ‡¯ğŸ‡µ' },
                { country: 'ì¤‘êµ­', city: 'ë² ì´ì§•', phone: '+86-10-8531-0700', flag: 'ğŸ‡¨ğŸ‡³' },
                { country: 'ì¤‘êµ­', city: 'ìƒí•˜ì´', phone: '+86-21-6295-5000', flag: 'ğŸ‡¨ğŸ‡³' },
                { country: 'ì¤‘êµ­', city: 'ì²­ë„', phone: '+86-532-8897-6001', flag: 'ğŸ‡¨ğŸ‡³' },
                { country: 'ì²´ì½”', city: 'í”„ë¼í•˜', phone: '+420-234-090-411', flag: 'ğŸ‡¨ğŸ‡¿' },
                { country: 'ìº„ë³´ë””ì•„', city: 'í”„ë†ˆíœ', phone: '+855-23-211-900', flag: 'ğŸ‡°ğŸ‡­' },
                { country: 'ìºë‚˜ë‹¤', city: 'ì˜¤íƒ€ì™€', phone: '+1-613-244-5010', flag: 'ğŸ‡¨ğŸ‡¦' },
                { country: 'ìºë‚˜ë‹¤', city: 'ë°´ì¿ ë²„', phone: '+1-604-681-9581', flag: 'ğŸ‡¨ğŸ‡¦' },
                { country: 'ìºë‚˜ë‹¤', city: 'í† ë¡ í† ', phone: '+1-416-920-3809', flag: 'ğŸ‡¨ğŸ‡¦' },
                { country: 'íƒœêµ­', city: 'ë°©ì½•', phone: '+66-81-914-5803', flag: 'ğŸ‡¹ğŸ‡­' },
                { country: 'íŠ€ë¥´í‚¤ì˜ˆ', city: 'ì•™ì¹´ë¼', phone: '+90-312-468-4821', flag: 'ğŸ‡¹ğŸ‡·' },
                { country: 'íŠ€ë¥´í‚¤ì˜ˆ', city: 'ì´ìŠ¤íƒ„ë¶ˆ', phone: '+90-212-368-8368', flag: 'ğŸ‡¹ğŸ‡·' },
                { country: 'í”„ë‘ìŠ¤', city: 'íŒŒë¦¬', phone: '+33-1-4753-0101', flag: 'ğŸ‡«ğŸ‡·' },
                { country: 'í•„ë¦¬í•€', city: 'ë§ˆë‹ë¼', phone: '+63-917-817-5703', flag: 'ğŸ‡µğŸ‡­' },
                { country: 'í•„ë¦¬í•€', city: 'ì„¸ë¶€', phone: '+63-917-808-3907', flag: 'ğŸ‡µğŸ‡­' },
                { country: 'í˜¸ì£¼', city: 'ìº”ë²„ë¼', phone: '+61-2-6270-4100', flag: 'ğŸ‡¦ğŸ‡º' },
                { country: 'í˜¸ì£¼', city: 'ì‹œë“œë‹ˆ', phone: '+61-2-9210-0200', flag: 'ğŸ‡¦ğŸ‡º' },
                { country: 'í™ì½©', city: 'í™ì½©', phone: '+852-2529-4141', flag: 'ğŸ‡­ğŸ‡°' },
            ],
            
            elements: {
                listContainer: null, searchInput: null, modal: null, flag: null, title: null, desc: null, callBtn: null
            },

            init: function() {
                try {
                    this.elements.listContainer = document.getElementById('sosListContainer');
                    this.elements.searchInput = document.getElementById('sosSearchInput');
                    this.elements.modal = document.getElementById('sosModal');
                    this.elements.flag = document.getElementById('sosModalFlag');
                    this.elements.title = document.getElementById('sosModalTitle');
                    this.elements.desc = document.getElementById('sosModalDesc');
                    this.elements.callBtn = document.getElementById('sosCallBtn');

                    if(this.elements.listContainer) this.renderList(this.data);

                    if(this.elements.searchInput) {
                        this.elements.searchInput.addEventListener('input', (e) => {
                            const term = e.target.value.toLowerCase().trim();
                            const filtered = this.data.filter(item => 
                                item.country.includes(term) || item.city.includes(term)
                            );
                            this.renderList(filtered);
                        });
                    }
                    
                    if(this.elements.modal) {
                        this.elements.modal.addEventListener('click', (e) => {
                            if(e.target === this.elements.modal) this.closeSOSModal();
                        });
                    }
                } catch(e) { console.error('SOS Init Error', e); }
            },

            renderList: function(data) {
                const container = this.elements.listContainer;
                if(!container) return;
                container.innerHTML = '';

                if (data.length === 0) {
                    container.innerHTML = `<div style="text-align:center; padding:30px; color:#64748b;">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</div>`;
                    return;
                }

                data.sort((a, b) => a.country.localeCompare(b.country));

                data.forEach(item => {
                    const div = document.createElement('div');
                    div.className = 'sos-list-item';
                    div.innerHTML = `
                        <div style="display:flex; align-items:center;">
                            <span style="font-size:20px; margin-right:10px;">${item.flag}</span>
                            <div>
                                <span class="sos-country">${item.country}</span>
                                <span class="sos-city">${item.city}</span>
                            </div>
                        </div>
                        <span class="material-icons-round sos-arrow">call</span>
                    `;
                    div.onclick = () => this.openSOSModal(item);
                    container.appendChild(div);
                });
            },

            openSOS: function() {
                // IMPORTANT: showPage is accessible here because it is defined in the IIFE
                if (typeof showPage === 'function') {
                    showPage('sosPage');
                } else {
                    console.error('showPage function not found');
                }
            },

            openSOSModal: function(item) {
                this.elements.flag.textContent = item.flag;
                this.elements.title.textContent = `${item.country} (${item.city})`;
                this.elements.desc.textContent = `ì£¼ ${item.country} ëŒ€í•œë¯¼êµ­ ì˜ì‚¬ê´€ìœ¼ë¡œ ì—°ê²°í•©ë‹ˆë‹¤.`;
                this.elements.callBtn.href = `tel:${item.phone}`;
                this.elements.modal.classList.add('open');
            },

            closeSOSModal: function() {
                this.elements.modal.classList.remove('open');
            }
        };

        const categoryEmojiMap = { 'í•œì‹ë‹¹/ì¹´í˜': 'ğŸ½ï¸', 'ë§ˆíŠ¸/ì‹í’ˆì ': 'ğŸ›’', 'ë·°í‹° ì„œë¹„ìŠ¤': 'ğŸ’‡', 'ì˜ë£Œ ì„œë¹„ìŠ¤': 'ğŸ¥', 'ë²•ë¥ /ì„¸ë¬´': 'âš–ï¸', 'ìƒí™œ ì„œë¹„ìŠ¤': 'ğŸ› ï¸', 'êµìœ¡/í•™ì›': 'ğŸ“š', 'ì´ì‚¬/ìš´ì†¡': 'ğŸ“¦', 'ì¢…êµ': 'â›ª' };
        const state = { allBusinessData: {}, currentResultsList: [], selectedLocation: '', selectedCategory: '', userLocation: null };
        const dom = {};
        
        function cacheDOMElements() {
            dom.loadingOverlay = document.getElementById('loadingOverlay');
            dom.featuredList = document.getElementById('featuredList');
            dom.newList = document.getElementById('newList');
            dom.locationGrid = document.querySelector('.location-grid');
            dom.serviceGrid = document.querySelector('.service-grid');
            dom.businessList = document.getElementById('businessList');
            dom.resultLocation = document.getElementById('resultLocation');
            dom.resultCategory = document.getElementById('resultCategory');
        }

        document.addEventListener('DOMContentLoaded', async function() { 
            cacheDOMElements(); 
            setupEventListeners(); 
            requestUserLocation();
            setupIntroAnimations();
            
            // Init SOS App (It is safe to call here)
            sosApp.init();
            
            // Initial History State
            if(window.history && window.history.replaceState) {
                window.history.replaceState({page: 'mainPage'}, '', '#mainPage');
            }

            await initAppOptimized();
        });

        // --- Navigation Logic ---
        window.addEventListener('popstate', (event) => {
            const page = event.state ? event.state.page : 'mainPage';
            _updateUIOnly(page);
            closeModals(); 
        });

        function showPage(id) {
            _updateUIOnly(id);
            if(window.history && window.history.pushState) {
                window.history.pushState({page: id}, '', `#${id}`);
            }
        }

        function _updateUIOnly(id) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            const target = document.getElementById(id);
            if(target) target.classList.add('active');
        }

        // Global functions for HTML onclick
        window.showPage = showPage;
        
        window.goBack = () => {
            if (window.history.length > 1) {
                window.history.back();
            } else {
                _updateUIOnly('mainPage');
            }
        };

        window.openCategoryURL = (url) => window.open(url, '_blank');
        window.goToSearch = () => showPage('searchPage');
        window.goToResults = () => showPage('resultsPage');
        window.doSearch = doSearch;
        
        // Expose sosApp to window so HTML onclick="sosApp.openSOS()" works
        window.sosApp = sosApp; 

        // --- Other Functions ---
        
        // PWA Install Logic
        let deferredPrompt;
        const installBanner = document.getElementById('installBanner');
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            if(installBanner) installBanner.style.display = 'flex';
        });
        window.installPWA = async () => {
            if (!deferredPrompt) return;
            deferredPrompt.prompt();
            const { outcome } = await deferredPrompt.userChoice;
            deferredPrompt = null;
            closeInstallBanner();
        };
        window.closeInstallBanner = () => {
            if(installBanner) installBanner.style.display = 'none';
        };

        // Modal & Legal Logic
        window.openInquiryModal = () => {
            document.getElementById('inquiryModal').classList.add('open');
        }
        window.openLegalModal = (type) => {
            if(type === 'terms') document.getElementById('termsModal').classList.add('open');
            if(type === 'privacy') document.getElementById('privacyModal').classList.add('open');
        }
        window.closeModals = () => {
            document.querySelectorAll('.modal-overlay').forEach(el => el.classList.remove('open'));
        }
        window.copyEmail = () => {
            navigator.clipboard.writeText('admin@kornect.kr').then(() => {
                const toast = document.getElementById('toast');
                toast.style.display = 'block';
                setTimeout(() => { toast.style.display = 'none'; }, 2000);
            });
        }
        document.querySelectorAll('.modal-overlay').forEach(overlay => {
            overlay.addEventListener('click', (e) => {
                if(e.target === overlay) window.closeModals();
            });
        });

        function setupIntroAnimations() {
            const introPage = document.getElementById('introPage');
            if(!introPage) return;
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                        observer.unobserve(entry.target);
                    }
                });
            }, { threshold: 0.1, root: introPage }); 
            introPage.querySelectorAll('.fade-in-up').forEach(el => observer.observe(el));
        }

        async function initAppOptimized() {
            try {
                const res = await fetch(GAS_WEB_APP_URL);
                if(!res.ok) throw new Error('Network error');
                const data = await res.json();
                if (data.error) throw new Error(data.error);
                processData(data);
            } catch (error) { 
                console.error('Error:', error);
                if(dom.featuredList) dom.featuredList.innerHTML = '<div style="padding:10px; font-size:13px; color:#ef4444">ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨</div>';
                if(dom.newList) dom.newList.innerHTML = '<div style="padding:10px; font-size:13px; color:#ef4444">ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨</div>';
            }
        }

        function processData(data) {
            state.allBusinessData = data.businessesByCategory;
            displayFeatured(data.featured, dom.featuredList);
            displayFeatured(data.new, dom.newList);
            populateFilters(data.filters);
        }

        function displayFeatured(items, container) {
            if (!container) return;
            container.innerHTML = ''; 
            if (!items || items.length === 0) { 
                container.innerHTML = '<div style="color:var(--text-sub); font-size:13px; padding:10px;">ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</div>'; 
                return; 
            }
            const fragment = document.createDocumentFragment();
            items.forEach(biz => {
                const card = document.createElement('div');
                card.className = 'biz-card-sm';
                card.onclick = () => handleCardClick(biz);
                card.innerHTML = `<div class="biz-title">${biz.name}</div><div class="biz-meta">${biz.category} â€¢ ${biz.location||'ìœ„ì¹˜'}</div><div class="biz-rating-badge">â­ ${biz.rating||0}</div>`;
                fragment.appendChild(card);
            });
            container.appendChild(fragment);
        }

        function populateFilters(filters) {
            if (!dom.locationGrid || !dom.serviceGrid) return;
            dom.locationGrid.innerHTML = filters.locations.map((loc, i) => `<div class="location-chip ${i===0?'selected':''}" data-value="${loc}">${loc}</div>`).join('');
            if(filters.locations[0]) state.selectedLocation = filters.locations[0];
            dom.serviceGrid.innerHTML = filters.categories.map(cat => `<div class="service-item" data-value="${cat}">${categoryEmojiMap[cat]||'â”'} ${cat}</div>`).join('');
        }

        function renderBusinessList(list) {
            if (!dom.businessList) return;
            dom.businessList.innerHTML = list.length ? list.map(biz => `
                <div class="business-card" onclick="handleCardClickProxy('${biz.name}')">
                    <div style="display:flex; justify-content:space-between"><div style="color:white; font-weight:700">${biz.name}</div><div style="color:#fbbf24; font-size:13px">â­ ${biz.rating||0}</div></div>
                    <div style="color:var(--text-sub); font-size:13px; margin-top:4px">ğŸ“ ${biz.address||'ì£¼ì†Œ ì—†ìŒ'}</div>
                </div>`).join('') : '<div style="text-align:center;color:var(--text-sub);padding:40px">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
            
            window.handleCardClickProxy = (name) => {
                const found = list.find(b => b.name === name);
                if(found) showDetail(found);
            };
        }

        function handleCardClick(biz) {
            if (biz.website && biz.website.length > 5) window.open(biz.website.startsWith('http')?biz.website:'https://'+biz.website, '_blank');
            else showDetail(biz);
        }

        function doSearch() {
            if (!state.selectedCategory || !state.selectedLocation) { alert('ìœ„ì¹˜ì™€ ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”'); return; }
            showLoading(); 
            setTimeout(() => {
                dom.resultLocation.textContent = state.selectedLocation; dom.resultCategory.textContent = state.selectedCategory;
                const data = state.allBusinessData[state.selectedCategory] || [];
                state.currentResultsList = data.filter(biz => biz.location && biz.location.includes(state.selectedLocation));
                renderBusinessList(state.currentResultsList);
                hideLoading(); 
                showPage('resultsPage'); 
            }, 300);
        }

        function showDetail(biz) {
            document.getElementById('detailName').textContent = biz.name;
            document.getElementById('detailRating').textContent = `${biz.rating||0} (${biz.reviews||0})`;
            document.getElementById('detailAddress').textContent = biz.address||'ì •ë³´ ì—†ìŒ';
            document.getElementById('detailPhone').textContent = biz.phone||'ì •ë³´ ì—†ìŒ';
            document.getElementById('detailHours').textContent = biz.hours||'ì •ë³´ ì—†ìŒ';
            
            const webItem = document.getElementById('websiteItem');
            if(biz.website && biz.website.length > 4 && biz.website !== 'ì •ë³´ ì—†ìŒ') {
                let url = biz.website.startsWith('http') ? biz.website : 'https://' + biz.website;
                document.getElementById('detailWebsite').innerHTML = `<a href="${url}" target="_blank" style="color:var(--primary-color)">í™ˆí˜ì´ì§€ ë°©ë¬¸</a>`;
                webItem.style.display = 'flex';
            } else { webItem.style.display = 'none'; }
            
            const callBtn = document.getElementById('callBtn');
            if (biz.phone && biz.phone !== 'ì •ë³´ ì—†ìŒ') {
                callBtn.href = `tel:${biz.phone.replace(/[^0-9+]/g,'')}`;
                callBtn.style.opacity = '1';
            } else { callBtn.href = '#'; callBtn.style.opacity = '0.5'; }

            const mapBtn = document.getElementById('mapBtn');
            const mapURL = biz.googleMapsUrl || biz.googleMapsURL || biz.mapURL;
            const query = biz.address && biz.address !== 'ì •ë³´ ì—†ìŒ' ? biz.address : biz.name;
            
            if (mapURL && mapURL !== 'ì •ë³´ ì—†ìŒ') {
                mapBtn.href = mapURL; mapBtn.target = "_blank";
            } else {
                mapBtn.href = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(query)}`;
                mapBtn.target = "_blank";
            }
            showPage('detailPage');
        }

        function showLoading() { if (dom.loadingOverlay) dom.loadingOverlay.classList.add('show'); }
        function hideLoading() { if (dom.loadingOverlay) dom.loadingOverlay.classList.remove('show'); }
        function requestUserLocation() { if (navigator.geolocation) navigator.geolocation.getCurrentPosition(pos => state.userLocation = pos.coords, () => state.userLocation = null); }
        function setupEventListeners() {
            document.addEventListener('click', e => {
                if (e.target.classList.contains('location-chip')) {
                    document.querySelectorAll('.location-chip').forEach(c => c.classList.remove('selected'));
                    e.target.classList.add('selected'); state.selectedLocation = e.target.dataset.value;
                } else if (e.target.classList.contains('service-item')) {
                    document.querySelectorAll('.service-item').forEach(i => i.classList.remove('selected'));
                    e.target.classList.add('selected'); state.selectedCategory = e.target.dataset.value;
                }
                
                if (e.target.id === 'detailPage' && window.innerWidth >= 768) {
                    goBack();
                }
            });
        }

        // iOS PWA External Link Fix
        document.addEventListener('click', function(e) {
            const anchor = e.target.closest('a');
            if (!anchor) return;
            
            const href = anchor.getAttribute('href');
            if (href && href.startsWith('http') && !href.includes(window.location.hostname)) {
                e.preventDefault();
                window.open(href, '_blank');
            }
        });
    })();
    </script>
</body>

</html>
